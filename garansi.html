<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Prasetya Studio Layanan Garansi</title>
  <link rel="icon" href="images/logo duwa.png" type="image/png">
  <!-- Google font Manrope -->
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <!-- Tailwind CDN (utility) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --brand: #3B83F6;
      --muted:#6B7280;
    }
    html,body{
      font-family: 'Manrope', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#f7fbff 0%, #ffffff 100%);
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .brand { color: var(--brand); }
    .btn-brand { background: var(--brand); color: white; }
    .card { background: white; border-radius: 12px; box-shadow: 0 6px 20px rgba(59,131,246,0.08); }
    .note { background:#f1f5f9;padding:.6rem;border-radius:.5rem;font-size:.95rem;color:var(--muted) }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center py-8 px-4">

  <!-- HEADER -->
  <header class="w-full max-w-4xl mb-8 text-center">
    <div class="flex flex-col items-center gap-2">
      <img src="images/logo duwa.png" alt="Logo Prasetya Studio" class="w-16 h-16 object-contain">
      <h1 class="text-3xl font-bold brand">Prasetya Studio Layanan Garansi</h1>
      <p class="text-sm text-gray-500">Urusan Desain Jadi Lebih Mudah</p>
    </div>
    
    <nav class="mt-4 flex justify-center gap-3 text-sm">
      <a href="#ketentuan" class="px-3 py-2 rounded hover:bg-slate-100">Ketentuan Garansi</a>
      <a href="#kalkulasi" class="px-3 py-2 rounded hover:bg-slate-100">Kalkulasi Garansi</a>
      <a href="klaim" class="px-3 py-2 rounded btn-brand">Halaman Klaim</a>
    </nav>
  </header>

  <main class="w-full max-w-4xl space-y-8">

    <!-- KETENTUAN -->
    <section id="ketentuan" class="card p-6">
      <h2 class="text-2xl font-bold mb-2">Ketentuan Garansi Layanan — <span class="brand">Prasetya Studio</span></h2>
      <p class="text-sm text-gray-600 mb-4">Semua ketentuan garansi berikut berlaku untuk layanan yang diterima oleh klien dari Prasetya Studio. Pilih jenis layanan untuk melihat ketentuan rinci.</p>

      <div class="grid gap-4 md:grid-cols-2">
        <div>
          <label class="block text-sm font-medium mb-2">Pilih Layanan</label>
          <select id="serviceSelect" class="w-full p-3 border rounded-md">
            <option value="desain">Desain Visual, Logo, Media Sosial, dll</option>
            <option value="video">Video Animasi</option>
            <option value="cv">Curriculum Vitae (CV)</option>
            <option value="lain">Layanan Lain</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium mb-2">Ringkasan Garansi</label>
          <div id="summaryBox" class="p-3 border rounded-md min-h-[84px]">
            <div class="text-sm text-gray-700">Pilih layanan untuk melihat ringkasan ketentuan garansi.</div>
          </div>
        </div>
      </div>

      <hr class="my-5" />
      <div id="detailsArea" class="space-y-4"></div>

      <div class="mt-4 text-xs text-gray-500">
        <div class="note">
          Catatan singkat: Periode garansi standar adalah <strong>10 hari</strong> sejak tanggal layanan. Proses klaim harus disertai bukti dan deskripsi masalah. Untuk mengajukan klaim gunakan tombol <strong>Halaman Klaim</strong>.
        </div>
      </div>
    </section>

    <!-- KALKULASI -->
    <section id="kalkulasi" class="card p-6">
      <h2 class="text-2xl font-bold mb-2">Kalkulasi Garansi</h2>
      <p class="text-sm text-gray-600 mb-4">Masukkan data layanan untuk menghitung sisa garansi dan dana yang akan dikembalikan (jika berlaku).</p>

      <form id="calcForm" class="space-y-4">
        <div class="grid gap-4 md:grid-cols-2">
          <div>
            <label class="block text-sm font-medium mb-2">Nama</label>
            <input required name="name" type="text" class="w-full p-3 border rounded-md" placeholder="Nama lengkap" />
          </div>

          <div>
            <label class="block text-sm font-medium mb-2">Nomor Invoice</label>
            <input required name="invoice" type="text" class="w-full p-3 border rounded-md" placeholder="INV-2025-xxxxx" />
          </div>

          <div>
            <label class="block text-sm font-medium mb-2">Tanggal Pelayanan</label>
            <input required id="serviceDate" name="date" type="date" class="w-full p-3 border rounded-md" />
          </div>

          <div>
            <label class="block text-sm font-medium mb-2">Harga Pelayanan (Rp)</label>
            <input required id="price" name="price" type="number" min="0" step="1" class="w-full p-3 border rounded-md" placeholder="Contoh: 100000" />
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Pilih Layanan</label>
          <select id="calcService" class="w-full p-3 border rounded-md">
            <option value="desain">Desain Visual, Logo, Media Sosial, dll</option>
            <option value="video">Video Animasi</option>
            <option value="cv">Curriculum Vitae (CV)</option>
            <option value="lain">Layanan Lain</option>
          </select>
        </div>

        <div class="flex gap-3 items-center">
          <button type="submit" class="px-4 py-2 rounded btn-brand">Hitung</button>
          <button id="downloadPdf" type="button" class="px-4 py-2 rounded btn-brand">Download PDF</button>
          <a id="toClaimBtn" href="klaim" class="ml-auto px-4 py-2 rounded border btn-brand/80 text-white" style="background:var(--brand);opacity:.95">Klaim</a>
        </div>
      </form>

      <div id="result" class="mt-6 p-4 border rounded-md hidden">
        <h3 class="text-lg font-semibold mb-2">Hasil Kalkulasi</h3>
        <div class="grid gap-2">
          <div class="flex justify-between"><span class="text-sm text-gray-600">Tanggal Pelayanan</span><strong id="resDate"></strong></div>
          <div class="flex justify-between"><span class="text-sm text-gray-600">Hari Sejak Pelayanan</span><strong id="resDays"></strong></div>
          <div class="flex justify-between"><span class="text-sm text-gray-600">Sisa Garansi (hari dari 10)</span><strong id="resRemain"></strong></div>
          <div class="flex justify-between"><span class="text-sm text-gray-600">Formulir Perhitungan</span><span id="resFormula" class="text-sm text-gray-700"></span></div>
          <div class="flex justify-between"><span class="text-sm text-gray-600">Dana yang akan dikembalikan (Rp)</span><strong id="resRefund" class="text-lg"></strong></div>
          <div class="pt-2 text-sm text-gray-600">
            <strong>Penjelasan:</strong> Garansi standar: <strong>10 hari</strong>. Dana pengembalian dihitung sebagai <strong>50%</strong> dari proporsi sisa garansi terhadap 10 hari. Jika garansi habis, nilai pengembalian = Rp 0.
          </div>
        </div>
      </div>
    </section>

    <footer class="w-full max-w-4xl text-center text-sm text-gray-500">
      © <span id="year"></span> Prasetya Studio — Semua hak dilindungi.
    </footer>

  </main>

  <!-- Floating Buttons -->
  <div class="fixed bottom-6 right-6 flex flex-col gap-3 z-50">
    <a href="https://wa.me/6285143080554" target="_blank" class="bg-green-500 w-14 h-14 flex items-center justify-center rounded-full shadow-lg hover:bg-green-600 transition">
      <i class='bx bxl-whatsapp text-2xl text-white'></i>
    </a>
    <a href="/home" class="bg-blue-500 w-14 h-14 flex items-center justify-center rounded-full shadow-lg hover:bg-blue-600 transition">
      <i class='bx bx-home text-2xl text-white'></i>
    </a>
  </div>

  <!-- JS Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="script.js"></script>

  <script>
    // populate year
document.getElementById('year').textContent = new Date().getFullYear();

// Ketentuan detail
const ketentuan = {
  desain: {
    title: 'Desain Visual',
    summary: 'Perbaikan minor gratis dalam masa garansi 10 hari. Revisi besar dilayani berbayar.',
    details: `
      <h4 class="text-lg font-semibold mb-2">Ketentuan Garansi — Desain Visual</h4>
      <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700">
        <li>Periode garansi: <strong>10 hari</strong> sejak tanggal selesai pekerjaan.</li>
        <li>Garansi mencakup perbaikan kesalahan teknis, kesalahan eksport file (format), dan penyesuaian minor pada elemen desain.</li>
        <li>Perubahan konsep besar atau revisi struktural akan dikenakan biaya tambahan.</li>
        <li>Permintaan garansi wajib disertai bukti dan nomor invoice.</li>
        <li>Perbaikan diselesaikan sesuai kapasitas tim; waktu perbaikan tidak memperpanjang periode garansi.</li>
        <li>Jika garansi diajukan setelah habis masa 10 hari, hak garansi dianggap hangus.</li>
      </ul>
    `
  },
  video: {
    title: 'Video Animasi',
    summary: 'Garansi 10 hari untuk perbaikan kesalahan render, sinkronisasi audio, atau file source.',
    details: `
      <h4 class="text-lg font-semibold mb-2">Ketentuan Garansi — Video Animasi</h4>
      <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700">
        <li>Periode garansi: <strong>10 hari</strong> sejak tanggal serah terima file final.</li>
        <li>Termasuk perbaikan render, subtitle salah posisi, atau sinkron audio kecil.</li>
        <li>Permintaan perubahan durasi signifikan atau revisi konsep tidak termasuk garansi gratis.</li>
      </ul>
    `
  },
  cv: {
    title: 'Curriculum Vitae (CV)',
    summary: 'Perbaikan tata letak dan typo kecil gratis selama 10 hari.',
    details: `
      <h4 class="text-lg font-semibold mb-2">Ketentuan Garansi — Curriculum Vitae</h4>
      <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700">
        <li>Periode garansi: <strong>10 hari</strong> sejak file final diserahkan.</li>
        <li>Perbaikan typo, ukuran font, dan tata letak ringan termasuk garansi.</li>
        <li>Perubahan data substansial atau penulisan ulang bukan bagian garansi gratis.</li>
      </ul>
    `
  },
  lain: {
    title: 'Layanan Lain',
    summary: 'Ketentuan menyesuaikan layanan; periode garansi standar 10 hari.',
    details: `
      <h4 class="text-lg font-semibold mb-2">Ketentuan Garansi — Layanan Lain</h4>
      <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700">
        <li>Periode garansi standar: <strong>10 hari</strong>.</li>
        <li>Garansi mencakup perbaikan teknis minor.</li>
        <li>Pekerjaan tambahan merupakan pekerjaan baru dan dikenakan biaya.</li>
      </ul>
    `
  }
};

// Render ketentuan
const serviceSelect = document.getElementById('serviceSelect');
const summaryBox = document.getElementById('summaryBox');
const detailsArea = document.getElementById('detailsArea');

function renderKetentuan(key){
  const k = ketentuan[key];
  summaryBox.innerHTML = `<div class="text-sm text-gray-700"><strong>${k.title}</strong><div class="text-sm text-gray-600 mt-1">${k.summary}</div></div>`;
  detailsArea.innerHTML = k.details;
}

// default
renderKetentuan('desain');

// sync dropdown
serviceSelect.addEventListener('change', e => {
  renderKetentuan(e.target.value);
  document.getElementById('calcService').value = e.target.value;
});
document.getElementById('calcService').addEventListener('change', e => {
  serviceSelect.value = e.target.value;
  renderKetentuan(e.target.value);
});

// Kalkulasi
const calcForm = document.getElementById('calcForm');
const resultBox = document.getElementById('result');
const resDate = document.getElementById('resDate');
const resDays = document.getElementById('resDays');
const resRemain = document.getElementById('resRemain');
const resRefund = document.getElementById('resRefund');
const resFormula = document.getElementById('resFormula');

function formatRp(n){
  if(isNaN(n) || n===Infinity) return 'Rp 0';
  return 'Rp ' + Math.round(n).toLocaleString('id-ID');
}

calcForm.addEventListener('submit', (ev)=>{
  ev.preventDefault();
  const data = new FormData(calcForm);
  const serviceDateValue = data.get('date');
  const priceValue = Number(data.get('price') || 0);

  if(!serviceDateValue){
    alert('Isi tanggal pelayanan terlebih dahulu.');
    return;
  }

  const today = new Date();
  const serviceDate = new Date(serviceDateValue + 'T00:00:00');
  const msPerDay = 24*60*60*1000;
  const daysSince = Math.floor((today - serviceDate)/msPerDay);
  const warrantyDays = 10;
  const remaining = Math.max(0, warrantyDays - daysSince);
  const refund = remaining>0 ? priceValue * (remaining/warrantyDays) * 0.5 : 0;

  resultBox.classList.remove('hidden');
  resDate.textContent = serviceDate.toLocaleDateString('id-ID',{year:'numeric',month:'2-digit',day:'2-digit'});
  resDays.textContent = (daysSince>=0?daysSince:0)+' hari';
  resRemain.textContent = remaining+' hari';
  resFormula.textContent = `Refund = Harga × (sisa / ${warrantyDays}) × 50%`;
  resRefund.textContent = formatRp(refund);
});

document.getElementById('downloadPdf').addEventListener('click', async () => {
  const data = new FormData(calcForm);
  const name = data.get('name') || '';
  const invoice = data.get('invoice') || '';
  const serviceDateValue = data.get('date');
  const priceValue = Number(data.get('price') || 0);
  const serviceType = document.getElementById('calcService').value;

  if(!serviceDateValue){
    alert('Isi tanggal pelayanan terlebih dahulu.');
    return;
  }

  const today = new Date();
  const serviceDate = new Date(serviceDateValue + 'T00:00:00');
  const msPerDay = 24*60*60*1000;
  const daysSince = Math.floor((today - serviceDate)/msPerDay);
  const warrantyDays = 10;
  const remaining = Math.max(0, warrantyDays - daysSince);
  const refund = remaining > 0 ? priceValue * (remaining / warrantyDays) * 0.5 : 0;
  const serviceName = ketentuan[serviceType]?.title || serviceType;
  const garansiNo = 'GR-' + Math.floor(Math.random()*900000+100000);

  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF({unit:'mm', format:'a4'});

  // Header
  pdf.setFont('helvetica','bold');
  pdf.setFontSize(18);
  pdf.setTextColor(59,131,246);
  pdf.text('Prasetya Studio', 15, 20);
  pdf.setFont('helvetica','normal');
  pdf.setFontSize(11);
  pdf.setTextColor(0,0,0);
  pdf.text('Urusan Desain Jadi Lebih Mudah', 15, 27);

  // Nomor Garansi & Tanggal Cetak
  pdf.setFontSize(10);
  pdf.text(`No. Garansi: ${garansiNo}`, 180, 15, {align:'right'});
  pdf.text(`Tanggal Cetak: ${today.toLocaleDateString('id-ID')}`, 180, 20, {align:'right'});

  pdf.setLineWidth(0.5);
  pdf.line(15,32,195,32);

  // Blok Informasi Customer & Layanan
  pdf.setFontSize(11);
  pdf.setFont('helvetica','bold');
  pdf.text('Detail Customer & Layanan', 15, 40);

  pdf.setFont('helvetica','normal');
  const startY = 46;
  const lineGap = 7;
  pdf.text(`Nama               : ${name}`, 15, startY);
  pdf.text(`Invoice            : ${invoice}`, 15, startY + lineGap);
  pdf.text(`Tanggal Pelayanan  : ${serviceDate.toLocaleDateString('id-ID')}`, 15, startY + lineGap*2);
  pdf.text(`Jenis Layanan      : ${serviceName}`, 15, startY + lineGap*3);

  pdf.text(`Hari Sejak Pelayanan : ${daysSince} hari`, 120, startY);
  pdf.text(`Sisa Garansi         : ${remaining} hari dari ${warrantyDays}`, 120, startY + lineGap);

// Box Dana Refund
const boxY = startY + lineGap*5;

// Warna biru muda solid
pdf.setFillColor(173,216,230); // LightBlue
pdf.setDrawColor(59,131,246);  // border biru
pdf.setLineWidth(0.5);

// Buat box dengan border dan rounded
pdf.roundedRect(15, boxY, 180, 40, 3, 3, 'FD'); // F=fill, D=draw border

// Judul box
pdf.setFont('helvetica','bold');
pdf.setFontSize(12);
pdf.setTextColor(0,0,0);
pdf.text('Dana yang Dikembalikan', 105, boxY + 12, {align:'center'});

// Nominal refund
pdf.setFontSize(16);
pdf.setTextColor(59,131,246);
pdf.text(formatRp(refund), 105, boxY + 28, {align:'center'});

  // Keterangan penting
  const noteY = boxY + 50;
  pdf.setFontSize(10);
  pdf.setFont('helvetica','normal');
  pdf.setTextColor(0,0,0);
  const note = 'Segera ajukan garansi ke admin sebelum masa garansi hangus. ' +
               'Periksa invoice dan nomor garansi saat menghubungi admin.';
  pdf.text(pdf.splitTextToSize(note, 180), 15, noteY);

  // Footer
  pdf.setFontSize(8);
  pdf.setTextColor(100);
  pdf.text(`Dicetak oleh komputer — ${today.toLocaleString('id-ID')}`, 105, 280, {align:'center'});

  pdf.save(`Faktur-Garansi-${invoice}.pdf`);

  function formatRp(n){
    if(isNaN(n) || n===Infinity) return 'Rp 0';
    return 'Rp ' + Math.round(n).toLocaleString('id-ID');
  }
});

  </script>

</body>
</html>
